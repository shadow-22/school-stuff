ORG 0800H
IN 10H

LXI B,00C8H    ;йахустеягсг DELB 200ms

START1:     
LDA 2000H     ;кгьг еисодоу
RLC           ;/екецвос MSB. ам аявийа еимаи 1 пеяилеме ма цимеи 0.
JC START1     ;/(лг амалемолемг кеитоуяциа се емам пяацлатийо диайоптг-BUTTON 
              ;/акка пяостехгйе ысте ма тгягхеи аустгяа г айокоухиа 
              ;/ом-OFF-ON TOY диайоптг пяойеилемоу ма емеяцопоигхоум та жыта.)
START2:
LDA 2000H
RLC           ;/AN TO MSB еимаи 0 циа пяытг жояа пеяилеме левяи ма цимеи 1
JNC START2    ;/

START3:
LDA 2000H
RLC           ;/ам то MSB еимаи 1 (емы пяим гтам 0) пеяилеме левяи ма цимеи 0
JC START3     ;/

LIGHTS_ON:    
MVI E,00H     ;аявийопоигсг сглаиас емдиалесоу екецвоу диайоптг
MVI A,00H     ;/амалла LED
STA 3000H     ;/


MVI D,96H     ;D=150 ысте 150*DELB(<--200ms)= 30sec

DELAY:        
CALL DELB     ;йкгсг вяомойахустеяHсгс циа 200ms  

CHECK_FOR_UPDATE:  ;екецвос циа аккацес стгм йатастасг тоу диайоптг.
LDA 2000H          ;/циа ма евоум амаьеи та жыта, тгм 1г жояа поу циметаи 
RLC                ;/аутос о екецвос о диайоптгс еимаи оFF.
JNC OFF            ;/аявийа г сглаиа екецвоу еимаи 0 (е=0).
MVI E,01H          ;/циметаи кгьг еисодоу. ам о диайоптгс еимаи ом (пяим гтам
JMP FIN            ;/сицоуяа OFF) H сглаиа циметаи 1 (е=1) йаи TO пяоцяалла
                   ;/сумевифеи тгм йахустеягсг тым 30sec.
OFF:               ;/AN O диайоптгс еимаи OFF екецветаи г йатастасг тгс сглаиас.
MOV A,E            ;/ам еимаи 0 (е=0) г йатастасг тоу диайоптг дем евеи акканеи
CPI 01H            ;/йаи то пяоцяалла сумевифеи тгм йахустеягсг тым 30sec.
JZ LIGHTS_ON       ;/AN еимаи 1 (е=1) о диайоптгс евеи цимеи OFF-ON-OFF диадовийа
                   ;/йаи етси амамеыметаи о вяомос тым 30sec.

FIN:
DCR D          ;/циметаи 150 жояес г диадийасиа: йахустеягсг 200ms - екецвос 
JNZ DELAY      ;/аккацгс KATAстасгс диайоптг

MVI A,FFH      ;/лета то пеяас тым 30sec та жыта сбгмоум.
STA 3000H      ;/то пяоцяалла епамеяветаи стом аявийо екецво тгс йатастасгс
JMP START1     ;/тоу диайоптг.

END