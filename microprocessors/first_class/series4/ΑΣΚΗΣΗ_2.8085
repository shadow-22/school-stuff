ORG 0809H     ; ои 0800-0806г вягсилопоиоумтаи циа апохгйеусг дедолемым.
IN 10H        ; апемеяцопоигсг пяостасиас лмглгс.

MVI A,0DH     ;/хесг ласйас диайопым.
SIM           ;/епитяеьг диайопым RST6.5.
EI            ;/


MVI B,64H     ; KATыжки й1
MVI C,C8H     ; йатыжки й2
LXI H,0802H
MVI M,10H     ;/ 0802-0805H ьгжиа охомгс поу дем вягсилопоиоумтаи.
INX H
MVI M,10H
INX H
MVI M,10H
INX H
MVI M,10H     ;/
INX H
MVI M,00H     ; 0806H: сглаиа диайопгс.

START:

LXI H,0806H   ;/екецвос сглаиас диайопгс.
MOV A,M       ;/ам еимаи 1, евеи сулбеи диайопг.
CPI 01H       ;/тоте пгцаиме стг диадийасиа енгпуяетгсгс тгс диайопгс.
JZ ROUT       ;/
MVI A,01H
CPI 00H       
JNZ START     ; бяовос амаломгс стгм аявийг йатасйасг.


ROUT:           ;диадийасиа енупгяетгсгс тгс диайопгс.
LXI H,0800H
MVI M,10H       ;/ сбгсило йаи тым 2 пяытым ьгжиым тгс охомгс.
INX H           ;/ вягсилопоиеитаи ысте ма лгм елжамифетаи то пяогцоулемо
MVI M,10H       ;/ лгмула стгм охомг левяи ма пкгйтяокоцгхеи о меос аяихлос.
LXI D,0800H     ;/
CALL STDM       ;/
CALL DCD        ;/
MVI A,FFH       ;\сбгсило LED циа том идио коцо поу пяоамажеяхгйе.
STA 3000H       ;\
LXI H,0806H
MVI M,00H       ; лгдемисе тг сглаиа диайопым.
LXI H,0800H
CALL KIND       ;диабасе то 1О ьгжио.
MOV M,A         ;апохгйеусе то стг лмглг (0800г).
MOV D,A
INX H
CALL KIND       ;диабасе то 2О ьгжио.
MOV M,A         ;апохгйеусе то стг лмглг (0801г).
RLC             
RLC 
RLC           
RLC             ;аяистеяг окисхгсг 4 жояес ысте ма паеи ста 4LSB TOY A.
ORA D           ;/коцийг пяосхесг ысте ои 2 йыдийои ма паяоум тг лояжг  
                ;/диьгжиоу Aяихлоу емос буте.
CMP B           ;суцйяиме том аяихло ле то йатыжки й1.
JC LOWER        ;/AN O Aяихлос еимаи лийтотеяос ╧ исос тоу й1, тоте
JZ LOWER        ;/бяисйетаи стгм пеяиовг [0-й1] (LOWER).
CMP C           ;\AN о аяихлос дем еимаи стгм пеяиовг [0-й1] суцйяиме том ле 
JC MEDIUM       ;\ то й2. ам еимаи лийяотеяос ╧ исос тоу й2 тоте о аяихлос 
JZ MEDIUM       ;\амгйеи стгм пеяиовг (й1-й2] (лEDIUM).
GREATER:        ;аккиыс о аяихлос амгйеи стгм пеяиовг (й2-FFH) (GREATER).
MVI A,DFH
STA 3000H       ;/амала йатаккгкоу LED амакоца ле тгм пеяиовг поу бяисйетаи
JMP SEG         ;/O аяихлос, сулжыма ле тгм ейжымгсг.  
MEDIUM:         ;/
MVI A,BFH       ;/
STA 3000H       ;/
JMP SEG         ;/
LOWER:          ;/
MVI A,7FH       ;/
STA 3000H       ;/
JMP SEG

SEG:            ;/елжамисг аяихлоу стгм охомг-йатастасг амаломгс диайопгс.
LXI D,0800H
CALL STDM
CALL DCD        
LXI H,0806H     ;/екецвос сглаиас диайопгс.
MOV A,M         ;/
CPI 01H         ;/
JZ ROUT 
JMP SEG


INTR_ROUTINE:   
DI              ;/апемеяцопоигсг диайопым.
                ;/айокоухеи лийяг вяомойахустеягсг. етси циа цягцояо патгла
                ;/тоу пкгйтяоу INTRPT дем пиаметаи г 2Г диайопг.

PUSH PSW
PUSH B
LXI B,0100H
CALL DELB     ;вяомойахустеягсг циа кгьг лиас диайопгс се ема патгла тоу INTRPT.
LXI H,0806H
MVI M,01H     ;хесг сглаиас диайопгс.
POP B
POP PSW
EI            ;епитяеьг диайопым циа еполемо патгла тоу пкгйтяоу INTRPT.
RET

END